#!/bin/bash

echo "--- ðŸ§¹ Running Spotless Check ---"

# 1. Run spotlessApply to fix formatting issues automatically
./backend/gradlew -p backend spotlessApply

# 2. Check if Spotless modified any files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=d)

if [ -n "$STAGED_FILES" ]; then
    echo "--- âž• Re-staging formatted files ---"
    # Filter for files that are actually inside the backend folder
    echo "$STAGED_FILES" | grep '^backend/' | xargs git add
fi

echo "âœ… Spotless finished."
exit 0